<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="password-generator.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:ital,wght@0,100;0,300;0,400;0,500;0,700;0,800;0,900;1,100;1,300;1,400;1,500;1,700;1,800;1,900&family=Alegreya:ital,wght@0,400..900;1,400..900&display=swap"
      rel="stylesheet"
    />

    <title>Generator haseł · WDAI 2025/2026</title>
  </head>

  <body>
    <header><h1>Generator haseł</h1></header>
    <main>
      <form>
        <input
          type="number"
          id="min-password-length"
          placeholder="Minimalna długość hasła (domyślnie 8)"
          min="1"
          step="1"
        />
        <input
          type="number"
          id="max-password-length"
          placeholder="Maksymalna długość hasła (domyślnie 16)"
          min="1"
          step="1"
        />
        <input type="checkbox" id="include-lowercase" checked />
        <label for="include-lowercase">Małe litery</label><br />
        <input type="checkbox" id="include-uppercase" checked />
        <label for="include-uppercase">Duże litery</label><br />
        <input type="checkbox" id="include-numbers" checked />
        <label for="include-numbers">Cyfry</label><br />
        <input type="checkbox" id="include-symbols" checked />
        <label for="include-symbols">Symbole</label><br />
      </form>
      <button id="generate-password">Generuj hasło</button>
    </main>
  </body>

  <script type="text/javascript">
    const CHAR_SETS = {
      lower: "abcdefghijklmnopqrstuvwxyz",
      upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
      number: "0123456789",
      symbol: "!@#$%^&*()-_=+[]{}|;:',.<>?/`~",
    };

    const randInt = (min, max) => Math.floor(Math.random() * (max - min)) + min;

    function generatePassword({
      min = 8,
      max = 16,
      lower = true,
      upper = true,
      number = true,
      symbol = true,
    } = {}) {
      const all = [
        lower && CHAR_SETS.lower,
        upper && CHAR_SETS.upper,
        number && CHAR_SETS.number,
        symbol && CHAR_SETS.symbol,
      ]
        .filter(Boolean)
        .join("");
      if (!all) return "";
      const len = randInt(min, max + 1);
      return Array.from(
        { length: len },
        () => all[Math.floor(Math.random() * all.length)]
      ).join("");
    }

    document
      .getElementById("generate-password")
      .addEventListener("click", () => {
        const minEl = document.getElementById("min-password-length");
        const maxEl = document.getElementById("max-password-length");
        const minRaw = Number.parseInt(minEl.value, 10);
        const maxRaw = Number.parseInt(maxEl.value, 10);

        // Defaults when empty
        const DEFAULT_MIN = 8;
        const DEFAULT_MAX = 16;

        // If user provided values, validate they're >= 1
        if (Number.isFinite(minRaw) && minRaw < 1) {
          alert(
            "Minimalna długość musi być liczbą całkowitą większą lub równą 1."
          );
          minEl.focus();
          return;
        }
        if (Number.isFinite(maxRaw) && maxRaw < 1) {
          alert(
            "Maksymalna długość musi być liczbą całkowitą większą lub równą 1."
          );
          maxEl.focus();
          return;
        }

        const min = Number.isFinite(minRaw) ? minRaw : DEFAULT_MIN;
        const max = Number.isFinite(maxRaw) ? maxRaw : DEFAULT_MAX;

        // Normalize order
        if (min > max) {
          alert(
            "Minimalna długość nie może być większa niż maksymalna długość."
          );
          minEl.focus();
          return;
        }

        // Cap high to avoid excessively large allocations
        const HARD_MAX = 1024;
        if (max > HARD_MAX) {
          if (
            !confirm(
              `Maksymalna długość jest większa niż ${HARD_MAX}. Ograniczyć do ${HARD_MAX}?`
            )
          )
            return;
          max = HARD_MAX;
        }

        const lowerChecked =
          document.getElementById("include-lowercase").checked;
        const upperChecked =
          document.getElementById("include-uppercase").checked;
        const numberChecked =
          document.getElementById("include-numbers").checked;
        const symbolChecked =
          document.getElementById("include-symbols").checked;

        if (
          !lowerChecked &&
          !upperChecked &&
          !numberChecked &&
          !symbolChecked
        ) {
          alert("Zaznacz przynajmniej jedną grupę znaków.");
          return;
        }

        const password = generatePassword({
          min,
          max,
          lower: lowerChecked,
          upper: upperChecked,
          number: numberChecked,
          symbol: symbolChecked,
        });

        alert(`Wygenerowane hasło: ${password}`);
      });
  </script>
</html>
